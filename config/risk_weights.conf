#!/usr/bin/env bash
# ============================================================================
# RootScope — config/risk_weights.conf
# Severity weights and per-check weight overrides.
# Used by the risk scoring engine to calculate aggregate risk.
# ============================================================================

# ---------------------------------------------------------------------------
# Base severity weights (numeric score per level)
# Higher weight = greater contribution to overall risk score.
# ---------------------------------------------------------------------------
WEIGHT_CRITICAL=100
WEIGHT_HIGH=75
WEIGHT_MEDIUM=40
WEIGHT_LOW=15
WEIGHT_INFO=5

# ---------------------------------------------------------------------------
# Risk score thresholds (aggregate score → overall risk rating)
# Applied to the sum of all weighted findings.
# ---------------------------------------------------------------------------
THRESHOLD_CRITICAL=500    # Score >= 500 → system is CRITICALLY at risk
THRESHOLD_HIGH=300        # Score >= 300 → HIGH overall risk
THRESHOLD_MEDIUM=150      # Score >= 150 → MEDIUM overall risk
THRESHOLD_LOW=50          # Score >= 50  → LOW overall risk
                          # Score < 50   → INFO (minimal risk)

# ---------------------------------------------------------------------------
# Per-check weight multipliers (override specific findings)
# Format: CHECK_WEIGHT_<CHECK_ID>=<multiplier>
# A multiplier of 2.0 doubles the base severity weight for that check.
# ---------------------------------------------------------------------------

# SUID binaries with known GTFOBins exploitation paths
CHECK_WEIGHT_SUID_GTFOBINS=2.0

# Writable /etc/passwd or /etc/shadow
CHECK_WEIGHT_WRITABLE_PASSWD=3.0
CHECK_WEIGHT_WRITABLE_SHADOW=3.0

# Kernel exploit matches
CHECK_WEIGHT_KERNEL_EXPLOIT=2.5

# Dangerous Linux capabilities (CAP_SYS_ADMIN, CAP_DAC_OVERRIDE, etc.)
CHECK_WEIGHT_DANGEROUS_CAPS=2.0

# Docker socket accessible by current user
CHECK_WEIGHT_DOCKER_SOCKET=2.5

# SSH private keys found readable
CHECK_WEIGHT_SSH_KEYS=1.5

# Plaintext credentials in config files
CHECK_WEIGHT_PLAINTEXT_CREDS=2.0

# Writable cron jobs or systemd units
CHECK_WEIGHT_WRITABLE_CRON=2.0
CHECK_WEIGHT_WRITABLE_SYSTEMD=2.0

# Sudo misconfigurations (NOPASSWD, wildcard abuse)
CHECK_WEIGHT_SUDO_NOPASSWD=2.5
CHECK_WEIGHT_SUDO_WILDCARD=2.0

# NFS shares with no_root_squash
CHECK_WEIGHT_NFS_NOSQUASH=1.5

# World-writable PATH directories
CHECK_WEIGHT_WRITABLE_PATH=2.0
